<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Interactivo Incoterms¬Æ 2020</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Fuente Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        .transition-width { transition: width 0.5s ease-in-out; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Iconos SVG (Inline para evitar dependencias externas complejas) ---
        const IconShip = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9 1 2.5 1S13.2 20 14.5 20c1.9 0 2.4 1 2.5 1 .5.5 1 1 1.5 1 2 0 3-2 3.5-2.5"/><path d="M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.9 5.8 2.8 8"/><path d="M10 10V4a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v6"/><polyline points="8 15 12 17 16 15"/><path d="M2.1 14.8c.2-.5.5-.8 1-.6s.8.5.6 1c-.2.5-.5.8-1 .6s-.8-.5-.6-1z"/><path d="M20.9 14.8c.2.5.5.8 1 .6s.8-.5.6-1c-.2-.5-.5-.8-1-.6s-.8.5-.6-1z"/></svg>
        );
        const IconTruck = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="13" x="2" y="5" rx="2"/><path d="M16 5v3.68a2 2 0 0 0 .54 1.35l2.5 2.65a2 2 0 0 1 .46 1.32V18"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>
        );
        const IconAlert = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>
        );
        const IconCheck = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"/></svg>
        );
        const IconPresentation = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="14" x="2" y="3" rx="2"/><line x1="8" x2="16" y1="21" y2="21"/><line x1="12" x2="12" y1="17" y2="21"/></svg>
        );

        // --- Base de Datos de Incoterms ---
        const incotermsData = [
            { id: 'EXW', name: 'EXW - Ex Works', desc: 'En F√°brica', sellerRisk: 10, buyerRisk: 90, sellerCost: 10, buyerCost: 90, type: 'any', details: 'El vendedor solo entrega la mercanc√≠a en sus instalaciones. El comprador asume TODO el riesgo y costo desde ah√≠.' },
            { id: 'FCA', name: 'FCA - Free Carrier', desc: 'Franco Porteador', sellerRisk: 25, buyerRisk: 75, sellerCost: 25, buyerCost: 75, type: 'any', details: 'El vendedor entrega al transportista designado por el comprador. Ideal para cualquier transporte y contenedores.' },
            { id: 'CPT', name: 'CPT - Carriage Paid To', desc: 'Transporte Pagado Hasta', sellerRisk: 25, buyerRisk: 75, sellerCost: 60, buyerCost: 40, type: 'any', details: 'El vendedor paga el transporte hasta el destino, pero el riesgo se transfiere al entregar al primer transportista.' },
            { id: 'CIP', name: 'CIP - Carriage & Insurance Paid', desc: 'Transporte y Seguro Pagados', sellerRisk: 25, buyerRisk: 75, sellerCost: 70, buyerCost: 30, type: 'any', details: 'Similar al CPT, pero el vendedor DEBE contratar un seguro de cobertura amplia (Cl√°usula A).' },
            { id: 'DAP', name: 'DAP - Delivered at Place', desc: 'Entregada en Lugar', sellerRisk: 80, buyerRisk: 20, sellerCost: 80, buyerCost: 20, type: 'any', details: 'El vendedor asume riesgos y costos hasta el lugar de destino, lista para descargar.' },
            { id: 'DPU', name: 'DPU - Delivered at Place Unloaded', desc: 'Entregada y Descargada', sellerRisk: 90, buyerRisk: 10, sellerCost: 90, buyerCost: 10, type: 'any', details: '√önico Incoterm donde el vendedor se encarga de descargar la mercanc√≠a en destino.' },
            { id: 'DDP', name: 'DDP - Delivered Duty Paid', desc: 'Entregada Derechos Pagados', sellerRisk: 95, buyerRisk: 5, sellerCost: 95, buyerCost: 5, type: 'any', details: 'M√°xima obligaci√≥n del vendedor. Incluye impuestos y aduanas de importaci√≥n.' },
            { id: 'FAS', name: 'FAS - Free Alongside Ship', desc: 'Franco al Costado del Buque', sellerRisk: 30, buyerRisk: 70, sellerCost: 30, buyerCost: 70, type: 'sea', details: 'Solo mar√≠timo. El vendedor entrega al costado del barco. No usar para contenedores (usar FCA).' },
            { id: 'FOB', name: 'FOB - Free On Board', desc: 'Franco a Bordo', sellerRisk: 40, buyerRisk: 60, sellerCost: 40, buyerCost: 60, type: 'sea', details: 'Solo mar√≠timo. El riesgo pasa cuando la carga est√° A BORDO. No usar para contenedores (usar FCA).' },
            { id: 'CFR', name: 'CFR - Cost and Freight', desc: 'Costo y Flete', sellerRisk: 40, buyerRisk: 60, sellerCost: 60, buyerCost: 40, type: 'sea', details: 'Solo mar√≠timo. Vendedor paga flete hasta puerto destino, pero riesgo pasa al cargar en origen.' },
            { id: 'CIF', name: 'CIF - Cost, Insurance & Freight', desc: 'Costo, Seguro y Flete', sellerRisk: 40, buyerRisk: 60, sellerCost: 70, buyerCost: 30, type: 'sea', details: 'Solo mar√≠timo. Como CFR, pero incluye seguro b√°sico (Cl√°usula C).' },
        ];

        // --- Componentes ---

        const ProgressBar = ({ label, value, colorClass }) => (
            <div className="mb-4">
                <div className="flex justify-between text-sm mb-1 font-semibold text-gray-700">
                    <span>{label}</span>
                    <span>{value}%</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-4 overflow-hidden shadow-inner">
                    <div 
                        className={`h-4 rounded-full transition-width ${colorClass}`} 
                        style={{ width: `${value}%` }}
                    ></div>
                </div>
            </div>
        );

        const TermCard = ({ term, isSelected, onClick }) => (
            <button 
                onClick={onClick}
                className={`w-full text-left p-4 rounded-lg mb-2 transition-all border-l-4 shadow-sm hover:shadow-md ${
                    isSelected 
                    ? 'bg-blue-50 border-blue-600 ring-2 ring-blue-200' 
                    : 'bg-white border-gray-300 hover:bg-gray-50'
                }`}
            >
                <div className="flex justify-between items-center">
                    <h3 className="font-bold text-lg text-gray-800">{term.id}</h3>
                    {term.type === 'sea' ? <IconShip className="text-blue-500 w-5 h-5"/> : <IconTruck className="text-green-500 w-5 h-5"/>}
                </div>
                <p className="text-sm text-gray-500">{term.desc}</p>
            </button>
        );

        const Wizard = ({ onRecommend }) => {
            const [step, setStep] = useState(1);
            const [transport, setTransport] = useState(null);
            
            const handleTransport = (type) => {
                setTransport(type);
                if (type === 'poly') {
                    // Si es polivalente, mostramos recomendaci√≥n directa
                    setStep(3);
                } else {
                    setStep(2);
                }
            };

            const handleContainer = (isContainer) => {
                if (isContainer) {
                    onRecommend('FCA'); // Recomendaci√≥n principal para contenedor
                } else {
                    onRecommend('FOB'); // Tradicional para granel
                }
            };

            return (
                <div className="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                    <h2 className="text-xl font-bold mb-4 text-gray-800 flex items-center gap-2">
                        <span className="bg-indigo-100 text-indigo-600 p-1 rounded">üßô‚Äç‚ôÇÔ∏è</span> Asistente de Selecci√≥n
                    </h2>
                    
                    {step === 1 && (
                        <div className="space-y-3">
                            <p className="mb-4">¬øQu√© tipo de transporte utilizar√°s?</p>
                            <button onClick={() => handleTransport('sea')} className="w-full p-3 bg-blue-50 text-blue-700 rounded hover:bg-blue-100 font-medium border border-blue-200 flex items-center gap-2 justify-center">
                                <IconShip className="w-5 h-5"/> Mar√≠timo / V√≠as Navegables
                            </button>
                            <button onClick={() => handleTransport('poly')} className="w-full p-3 bg-green-50 text-green-700 rounded hover:bg-green-100 font-medium border border-green-200 flex items-center gap-2 justify-center">
                                <IconTruck className="w-5 h-5"/> Polivalente / A√©reo / Terrestre
                            </button>
                        </div>
                    )}

                    {step === 2 && transport === 'sea' && (
                        <div className="space-y-3">
                            <p className="mb-4">¬øLa mercanc√≠a viaja en contenedor?</p>
                            <button onClick={() => handleContainer(true)} className="w-full p-3 bg-purple-50 text-purple-700 rounded hover:bg-purple-100 font-medium border border-purple-200">
                                ‚úÖ S√≠, en contenedor
                            </button>
                            <button onClick={() => handleContainer(false)} className="w-full p-3 bg-gray-50 text-gray-700 rounded hover:bg-gray-100 font-medium border border-gray-200">
                                ‚ùå No, a granel / carga general
                            </button>
                            <button onClick={() => setStep(1)} className="text-sm text-gray-400 mt-2 underline">Volver</button>
                        </div>
                    )}

                    {step === 3 && (
                        <div className="text-center">
                            <p className="text-green-600 font-bold mb-2">Recomendaci√≥n:</p>
                            <p className="text-sm text-gray-600 mb-4">Para transporte polivalente, usa reglas "Cualquier Modo".</p>
                            <button onClick={() => onRecommend('FCA')} className="bg-indigo-600 text-white px-4 py-2 rounded shadow hover:bg-indigo-700">
                                Ver Reglas Multimodales (FCA, CPT...)
                            </button>
                            <button onClick={() => setStep(1)} className="block w-full text-sm text-gray-400 mt-4 underline">Reiniciar</button>
                        </div>
                    )}
                </div>
            );
        };

        const App = () => {
            const [selectedId, setSelectedId] = useState('EXW');
            const [presentationMode, setPresentationMode] = useState(false);
            const [tab, setTab] = useState('visualizer'); // 'visualizer' | 'wizard'

            const selectedTerm = incotermsData.find(t => t.id === selectedId);

            const handleRecommendation = (termId) => {
                setSelectedId(termId);
                setTab('visualizer');
            };

            return (
                <div className={`min-h-screen ${presentationMode ? 'bg-gray-900 text-white' : 'bg-gray-50 text-gray-800'}`}>
                    
                    {/* Header */}
                    <header className={`${presentationMode ? 'bg-gray-800 border-gray-700' : 'bg-white border-b border-gray-200'} p-4 shadow-sm sticky top-0 z-10`}>
                        <div className="max-w-6xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-2">
                                <span className="text-2xl">üì¶</span>
                                <h1 className="font-bold text-xl md:text-2xl tracking-tight">Incoterms¬Æ 2020 <span className="text-blue-500 font-light">Visualizer</span></h1>
                            </div>
                            <div className="flex gap-2">
                                {!presentationMode && (
                                    <div className="bg-gray-100 p-1 rounded-lg flex text-sm">
                                        <button 
                                            onClick={() => setTab('visualizer')}
                                            className={`px-3 py-1 rounded-md transition-colors ${tab === 'visualizer' ? 'bg-white shadow text-blue-600' : 'text-gray-500'}`}
                                        >Explorar</button>
                                        <button 
                                            onClick={() => setTab('wizard')}
                                            className={`px-3 py-1 rounded-md transition-colors ${tab === 'wizard' ? 'bg-white shadow text-blue-600' : 'text-gray-500'}`}
                                        >Asistente</button>
                                    </div>
                                )}
                                <button 
                                    onClick={() => setPresentationMode(!presentationMode)}
                                    className={`p-2 rounded-full hover:bg-opacity-20 hover:bg-gray-500 transition-all ${presentationMode ? 'text-yellow-400' : 'text-gray-600'}`}
                                    title="Modo Presentaci√≥n"
                                >
                                    <IconPresentation className="w-6 h-6" />
                                </button>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-6xl mx-auto p-4 md:p-6">
                        
                        {tab === 'wizard' && !presentationMode ? (
                            <div className="flex justify-center mt-10">
                                <div className="w-full max-w-md">
                                    <Wizard onRecommend={handleRecommendation} />
                                </div>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 md:grid-cols-12 gap-6">
                                
                                {/* Sidebar Lista */}
                                <div className={`md:col-span-4 lg:col-span-3 space-y-2 ${presentationMode ? 'hidden' : 'block'}`}>
                                    <div className="overflow-y-auto max-h-[80vh] pr-2 custom-scrollbar">
                                        <p className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 px-1">Cualquier Modo</p>
                                        {incotermsData.filter(t => t.type === 'any').map(term => (
                                            <TermCard 
                                                key={term.id} 
                                                term={term} 
                                                isSelected={selectedId === term.id} 
                                                onClick={() => setSelectedId(term.id)} 
                                            />
                                        ))}
                                        <p className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 mt-4 px-1">Mar√≠timo</p>
                                        {incotermsData.filter(t => t.type === 'sea').map(term => (
                                            <TermCard 
                                                key={term.id} 
                                                term={term} 
                                                isSelected={selectedId === term.id} 
                                                onClick={() => setSelectedId(term.id)} 
                                            />
                                        ))}
                                    </div>
                                </div>

                                {/* Panel Principal */}
                                <div className={`${presentationMode ? 'md:col-span-12 max-w-4xl mx-auto' : 'md:col-span-8 lg:col-span-9'}`}>
                                    <div className={`${presentationMode ? 'bg-gray-800 border-gray-700' : 'bg-white'} rounded-2xl shadow-xl overflow-hidden border border-gray-200 transition-colors duration-300`}>
                                        
                                        {/* Header de la Tarjeta */}
                                        <div className={`p-6 md:p-8 border-b ${presentationMode ? 'border-gray-700 bg-gray-800' : 'border-gray-100 bg-gradient-to-r from-gray-50 to-white'}`}>
                                            <div className="flex justify-between items-start">
                                                <div>
                                                    <h2 className={`text-4xl md:text-5xl font-extrabold mb-2 ${presentationMode ? 'text-white' : 'text-gray-900'}`}>
                                                        {selectedTerm.id}
                                                    </h2>
                                                    <p className={`text-xl md:text-2xl font-light ${presentationMode ? 'text-gray-300' : 'text-gray-600'}`}>
                                                        {selectedTerm.name}
                                                    </p>
                                                </div>
                                                <div className={`p-3 rounded-full ${selectedTerm.type === 'sea' ? 'bg-blue-100 text-blue-600' : 'bg-green-100 text-green-600'}`}>
                                                    {selectedTerm.type === 'sea' ? <IconShip className="w-8 h-8"/> : <IconTruck className="w-8 h-8"/>}
                                                </div>
                                            </div>
                                            <p className={`mt-4 text-lg leading-relaxed ${presentationMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                {selectedTerm.details}
                                            </p>
                                        </div>

                                        {/* Gr√°ficos */}
                                        <div className="p-6 md:p-8 space-y-8">
                                            
                                            {/* Secci√≥n Riesgo */}
                                            <div>
                                                <div className="flex items-center gap-2 mb-4">
                                                    <div className="w-1 h-6 bg-red-500 rounded-full"></div>
                                                    <h3 className={`font-bold text-lg ${presentationMode ? 'text-gray-200' : 'text-gray-800'}`}>Transferencia de Riesgo</h3>
                                                </div>
                                                
                                                <div className="space-y-4">
                                                    <div>
                                                        <div className="flex justify-between mb-1">
                                                            <span className={`text-sm font-medium ${presentationMode ? 'text-blue-300' : 'text-blue-700'}`}>Vendedor (Exportador)</span>
                                                            <span className="text-sm font-bold">{selectedTerm.sellerRisk}%</span>
                                                        </div>
                                                        <div className="w-full bg-gray-700/10 rounded-full h-5 overflow-hidden">
                                                            <div className="h-5 bg-blue-500 rounded-full transition-width" style={{width: `${selectedTerm.sellerRisk}%`}}></div>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <div className="flex justify-between mb-1">
                                                            <span className={`text-sm font-medium ${presentationMode ? 'text-orange-300' : 'text-orange-700'}`}>Comprador (Importador)</span>
                                                            <span className="text-sm font-bold">{selectedTerm.buyerRisk}%</span>
                                                        </div>
                                                        <div className="w-full bg-gray-700/10 rounded-full h-5 overflow-hidden">
                                                            <div className="h-5 bg-orange-400 rounded-full transition-width" style={{width: `${selectedTerm.buyerRisk}%`}}></div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p className="text-xs text-gray-400 mt-2 text-right">El punto donde termina la barra azul es donde el riesgo se transfiere.</p>
                                            </div>

                                            {/* Secci√≥n Costo */}
                                            <div>
                                                 <div className="flex items-center gap-2 mb-4">
                                                    <div className="w-1 h-6 bg-green-500 rounded-full"></div>
                                                    <h3 className={`font-bold text-lg ${presentationMode ? 'text-gray-200' : 'text-gray-800'}`}>Transferencia de Costo</h3>
                                                </div>
                                                <div className="relative pt-6 pb-2">
                                                    <div className="flex mb-2 items-center justify-between text-xs uppercase font-bold tracking-widest text-gray-400">
                                                        <span>Origen</span>
                                                        <span>Destino</span>
                                                    </div>
                                                    <div className="h-4 bg-gray-200 rounded-full overflow-hidden flex">
                                                        <div 
                                                            className="h-full bg-green-600 flex items-center justify-center text-[10px] text-white font-bold transition-width" 
                                                            style={{width: `${selectedTerm.sellerCost}%`}}
                                                        >
                                                            Vendedor
                                                        </div>
                                                        <div 
                                                            className="h-full bg-yellow-400 flex items-center justify-center text-[10px] text-yellow-900 font-bold transition-width" 
                                                            style={{width: `${selectedTerm.buyerCost}%`}}
                                                        >
                                                            Comprador
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Advertencias */}
                                            {(selectedTerm.id === 'FOB' || selectedTerm.id === 'CIF' || selectedTerm.id === 'CFR') && (
                                                <div className="mt-6 p-4 bg-amber-50 border border-amber-200 rounded-lg flex gap-3">
                                                    <IconAlert className="text-amber-600 flex-shrink-0" />
                                                    <div>
                                                        <h4 className="font-bold text-amber-800 text-sm">¬°Advertencia!</h4>
                                                        <p className="text-sm text-amber-700 mt-1">
                                                            Esta regla es exclusiva para transporte mar√≠timo. Si la mercanc√≠a viaja en <strong>contenedor</strong>, se recomienda usar <strong>{selectedTerm.id === 'FOB' ? 'FCA' : 'CIP/CPT'}</strong>, ya que el riesgo en contenedores suele transferirse antes de cargar el buque.
                                                        </p>
                                                    </div>
                                                </div>
                                            )}

                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    <footer className="text-center p-6 text-gray-400 text-sm">
                        <p>¬© Manual Interactivo Incoterms 2020. Solo fines educativos.</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>